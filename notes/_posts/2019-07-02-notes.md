---
layout: post
title: "2019-07-02"
date: 2019-07-02
tags: [front-end]
comments: true
share: true
---

> [2019-07-03]浏览器跨域: 简单请求和非简单请求<br>
> [2019-07-02]线上出bug, 通过报错信息及本地source-map定位问题 <br>

##### [2019-07-03]浏览器跨域: 简单请求和非简单请求

当前端进行跨域请求时, 浏览器针对简单请求和非简单请求有不同的处理

如果为简单请求, 浏览器会把直接发送, 而如果是非简单请求, 浏览器会先发一个`OPTIONS`请求确认服务器支持`CORS`, OPTIONS请求成功之后才会帮我们发出真正的业务请求

而只要满足以下所有条件即为`简单请求`

1. 请求方式只能是: GET, POST, HEAD
1. 不得人为设置下面集合以外的HTTP请求头字段
    - Accept, Accept-Language, Content-Language, Content-Type, DPR, Downlink, Save-Date, Viewport-Width, Width
1. Content-Type只能取以下值
    - application/x-www-form-urlencoded, multipart/form-data, text/plain
1. 请求中的任意`XMLHttpRequestUpload`对象均没有注册任何事件监听器
1. 请求中没有使用`ReadableStream`对象

##### [2019-07-02]线上出bug, 通过报错信息及本地source-map定位问题

前端代码上线时不能把source-map同时上线, 因为source-map里包含了源码的信息, 只要通过工具就可以还原源码, 造成源码泄露

一般而言都需要搭配监控体系来完成生产, 生产环境报错会记录到监控后台, 获取到错误堆栈信息再通过[source-map](https://www.npmjs.com/package/source-map)的api即可定位源码信息

大家可以查阅[《线上出bug了？别怕，这么定位！》](https://juejin.im/post/5c8bbb30f265da2dc539008c)这篇文章后半部分内容.
