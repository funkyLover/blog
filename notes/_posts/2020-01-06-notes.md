---
layout: post
title: "2020-01-06"
date: 2020-01-06
tags: [ffmpeg, webpack]
comments: true
share: true
---

> [2020-01-07]Webpack splitChunks 的 cacheGroups 配置只有两个生效 <br>
> [2020-01-06]使用 ffmpeg 把 flv 转化成 mp4 <br>

##### [2020-01-07]Webpack splitChunks 的 cacheGroups 配置只有两个生效

使用 vue-cli@3.x 创建的 vue 项目, 想增加 cacheGroups 配置, 优化 chunks 的缓存, 结果死活不生效

后面定位到是因为 vue-cli 默认会为我们生成两个 cacheGroups 配置, 而项目中按需自行加上 runtimeChunk 以及本本身包含的入口 chunk

就是页面初始化已有4个并行请求, 而 splitChunk.maxInitialRequests 默认配置是4, 所以超过4个初始 chunk 后, cacheGroups 中优先级最低的 chunk 会被忽略, 转而打包到每一个入口中

所以如果我们要增加缓存组, 可以修改 maxInitialRequests, 或使用缓存组中 `enforce` 配置使其强制生效

##### [2020-01-06]使用 ffmpeg 把 flv 转化成 mp4

```bash
# from https://superuser.com/questions/624565/ffmpeg-convert-flv-to-mp4-without-losing-quality
ffmpeg -i filename.flv -c:v libx264 -crf 19 -strict experimental filename.mp4
```
